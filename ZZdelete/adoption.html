<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Bla bla">
    <link rel="stylesheet" href="../styles/prod.css">
    <link rel="stylesheet" href="../styles/cartDialog.css">
    <script src="/components/my-footer.js" type="module" defer></script>
    <script src="/components/my-header.js" type="module" defer></script>
    <title>One product</title>
</head>

<body>

    
    <!-- Header -->
    <my-header></my-header>
    <article class="cartDialog">
        <h1>üõí ${this.sagsniiToo} –ë“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω</h1>
        <aside class="listbtn">
            <button class="closee">–•–∞–∞—Ö</button>
            <button class="checkout"><a href="cart.html">–ó–∞—Ö–∏–∞–ª–∞—Ö</a></button>
        </aside>
    </article>
    <h3>hjsfk</h3>

    <!-- –°–∞–≥—Å–Ω—ã –¥–∏–∞–ª–æ–≥ -->
    <dialog class="cartDialog">
        <h1>üõí –ë“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω</h1>
        <aside class="listbtn">
            <button class="closee">CLOSE</button>
            <a href="cart.html" class="checkout">–ó–∞—Ö–∏–∞–ª–∞—Ö</a>
        </aside>
    </dialog>

    <button id="open-dialog" style="position: fixed; top: 20px; left: 20px;">
        –°–∞–≥—Å—ã–≥ –Ω—ç—ç—Ö
    </button>

    <!-- Footer -->
    <my-footer></my-footer>

    <script>
        // –î–∏–∞–ª–æ–≥—ã–≥ –Ω—ç—ç–∂ —Ö–∞–∞—Ö –ª–æ–≥–∏–∫
        const cartDialog = document.querySelector(".cartDialog");
        const closeDialogButton = document.querySelector(".closee");
        const openDialogButton = document.querySelector("#open-dialog");

        // –î–∏–∞–ª–æ–≥—ã–≥ –Ω—ç—ç—Ö —Ç–æ–≤—á
        openDialogButton.addEventListener("click", () => {
            if (cartDialog) {
                cartDialog.showModal(); // –î–∏–∞–ª–æ–≥—ã–≥ —Ö–∞—Ä—É—É–ª–Ω–∞
            }
        });

        // –î–∏–∞–ª–æ–≥—ã–≥ —Ö–∞–∞—Ö —Ç–æ–≤—á
        if (closeDialogButton) {
            closeDialogButton.addEventListener("click", () => {
                cartDialog.close(); // –î–∏–∞–ª–æ–≥—ã–≥ —Ö–∞–∞–Ω–∞
            });
        }


            // –≠–Ω–¥ 'add-to-cart' —Ç–æ–≤—á–ª—É—É—Ä –¥—ç—ç—Ä —Å–æ–Ω–≥–æ–ª—Ç—É—É–¥—ã–≥ –∞–≤–∞—Ö “Ø–π–ª–¥–ª–∏–π–≥ —Ö–∏–π–∂ –±–∞–π–Ω–∞
    setupAddToCartButton() {
        document.getElementById('cart-button').addEventListener('click', function () {
            console.log("Clicked.");
    
            // –ó”©–≤—Ö”©–Ω —Å–æ–Ω–≥–æ—Å–æ–Ω —É—Ç–≥—É—É–¥—ã–≥ –∞–≤–∞—Ö
            const sizeElement = document.querySelector('input[name="choice_size"]:checked');
            if (!sizeElement) {
                alert("–•—ç–º–∂—ç—ç–≥ —Å–æ–Ω–≥–æ–Ω–æ —É—É.");
                return;
            }
            const size = sizeElement.nextElementSibling.innerText;  // –•—ç–º–∂—ç—ç–Ω–∏–π –Ω—ç—Ä–∏–π–≥ –∞–≤–∞—Ö
    
            const colorElement = document.querySelector('input[name="choice_color"]:checked');
            if (!colorElement) {
                alert("”®–Ω–≥”©”© —Å–æ–Ω–≥–æ–Ω–æ —É—É.");
                return;
            }
            const color = colorElement.nextElementSibling.innerText;  // ”®–Ω–≥”©–Ω–∏–π –Ω—ç—Ä–∏–π–≥ –∞–≤–∞—Ö
            
            // –ë“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω–∏–π –º—ç–¥—ç—ç–ª–ª–∏–π–≥ –∞–≤–∞—Ö
            const productData = {
                id: this.id,
                name: this.name,
                size: size,
                color: color,
                price: this.price,
                mainpic: this.mainpic,
                subpic: this.subpic
            };
    
            // localStorage-–¥ –±“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω–∏–π –º—ç–¥—ç—ç–ª–ª–∏–π–≥ —Ö–∞–¥–≥–∞–ª–∞—Ö
            const cartData = JSON.parse(localStorage.getItem('cart')) || []; // –•—ç—Ä—ç–≤ cart “Ø“Ø—Å—ç—ç–≥“Ø–π –±–æ–ª —Ö–æ–æ—Å–æ–Ω –º–∞—Å—Å–∏–≤ –∞–≤–Ω–∞
            cartData.push(productData); // –ë“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω –Ω—ç–º—ç—Ö
            localStorage.setItem('cart', JSON.stringify(cartData)); // localStorage-–¥ —Ö–∞–¥–≥–∞–ª–∞—Ö

            document.getElementById("my-cart").addProduct();
            // my-cart –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã–Ω addProduct —Ñ—É–Ω–∫—Ü –¥—ç—ç—Ä localStorage-–¥ —Ö–∞–¥–≥–∞–ª–∞–≥–¥—Å–∞–Ω ”©–≥”©–≥–¥–ª–∏–π–≥ –∞—à–∏–≥–ª–∞—Ö
            document.getElementById("my-cart").addProduct(productData);
            alert('–ë“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω —Å–∞–≥—Å–∞–Ω–¥ –Ω—ç–º—ç–≥–¥–ª—ç—ç.');
    
            // app.cart.addProduct –±–æ–ª–æ–Ω app.refreshCart —Ñ—É–Ω–∫—Ü—É—É–¥—ã–≥ –¥—É—É–¥–Ω–∞
            app.cart.addProduct(this.id);
            app.refreshCart();
        });
    }
    </script>




</body>

</html>
